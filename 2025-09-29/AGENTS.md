# エージェント運用ガイド

## 目的
- Serena MCPを前提に、複数エージェントが一貫した品質でプレゼン資料を整備するための共通リファレンス
- 本ドキュメント内のデザイン/資料作成ガイドラインを全エージェントに共有し、解釈のブレをなくす
- 作業手順と検証フローを標準化し、無駄な応答往復を減らす

## プロジェクト概要
- Serena MCPに関する登壇資料（Slidev使用）

## 資料共通ガイドライン

### デザイン確認・修正方針
#### 重要原則
**デザインを確認、作成、修正するときは必ずPlaywright MCPを使用すること**

- スライドのレイアウト確認時はPlaywright MCPでブラウザを開く
- デザイン変更後は必ずPlaywright MCPで表示を確認
- レイアウト崩れや文字サイズの問題もPlaywright MCPで視覚的に確認

### 資料作成の基本方針
#### 重要原則
**資料は発表ありきではなく、資料単体で完結すること**

- 後日共有されることを前提に作成
- 資料だけ見ても内容が理解できるようにする
- 口頭説明に依存しない情報設計
- アイコンやロゴだけでなく、必ず日本語のラベルを併記

#### 具体例
❌ 悪い例: ロゴだけで「🏢」→ 何の会社か不明
✅ 良い例: 「🏢 所属: Studio Inc.」→ 明確

### 技術スタック
- Slidev
- Tailwind CSS (UnoCSS)
- Markdown

### デザインガイドライン
#### カラーパレット
- 背景: #000000（黒）
- テキスト: #ffffff（白）、#e5e5e5（グレー）
- アクセント: #00ffff（シアン）
- 強調: #ff0040（赤）

#### ロゴ配置
- タイトルスライド: 右下に控えめ
- その他スライド: 右下にシンボルロゴ（小）

#### フォントサイズ
- h1: 3.5rem以上
- h2: 2.5rem
- 本文: 1.5rem以上

### スライド構成
1. タイトル
2. 自己紹介
3. 課題
4. 今日のゴール
5. コンテキストエンジニアリング説明
6. 実例・デモ
7. まとめ

### 命名規則
- ファイル名: kebab-case
- クラス名: Tailwind utility classes
- アセット: /assets/配下に配置

## 運用共通原則
- すべての作業は本ドキュメントを確認したうえで着手する
- Serena MCP経由でリポジトリコンテキストを自動供給し、会話内での手動共有を極力避ける
- 途中参入エージェントも含め、最新状況はGit/ファイルを直接確認し「推測で書かない」
- 変更後はPlaywright MCPなどでアウトプットを可視確認し、スクリーンショット無しでの合意形成を避ける

## エージェント別ガイド

### Claude Code (Claude Desktop)
- Claude DesktopでSerena MCPサーバーを有効化し、`serena.config.json`の`claudeMd`に`./AGENTS.md`を設定して自動読み込みさせる
- デザイン確認・レイアウト調整は**必ずPlaywright MCP**を用い、本ドキュメントの「資料共通ガイドライン」を順守する
- スライド修正時は`slides.md`と`slides_backup.md`を比較し、不要な差分を生まない
- 口頭前提の説明は禁止。「資料単体で完結」するよう本文と注記を充実させる

### Codex CLI (GPT-5 / Codex Agent)
- コマンド実行は`shell`ツール経由で行い、原則`["bash", "-lc", "<command>"]`形式（必要に応じて`workdir`指定）
- 複雑な変更作業前には`plan`ツールでステップを共有し、1ステップずつステータス更新する
- ファイル編集はASCIIを基本とし、理由なく非ASCIIを増やさない（日本語が必要な場合のみ利用）
- 既存の未コミット変更は尊重し、元に戻したり上書きしない。想定外の変更を検知したら直ちにユーザーへ確認
- コードコメントは最小限、冗長な説明を避ける。root原因の調査やテスト実行は可能な限りローカルで完結
- 最終レスポンスでは変更内容→背景→次の推奨アクションの順で簡潔に共有する

### Playwright MCP
- Slidevでの表示確認、文字切れ、背景・配色の破綻チェックを担当
- スライドごとに主要なスクリーンショットを取得し、エージェント間で視覚的な共通認識を作る
- コンポーネント追加時はDOM構造やTailwindクラスが本ドキュメントのガイドラインに沿っているか確認

### Serena MCP
- `serena init`（初回のみ）→ `serena start`でMCPサーバーを起動し、Claude Desktopへ登録
- `serena.config.json`で`project`/`claudeMd`/`ignore`を設定し、`claudeMd`は`./AGENTS.md`を指定、意図しない大容量ディレクトリを除外
- エージェントからの`/agents`コマンドでSerena MCPが認識されていることを随時確認
- 役割: プロジェクト構造・主要ドキュメント・コーディング規約をリアルタイムに供給し、コンテキストを維持

## コラボレーションフロー
1. **同期**: `git status`と主要ファイルの最新状態を確認。Serena MCPが稼働しているかチェック
2. **設計**: 本ドキュメントの「資料共通ガイドライン」を参照しながらスライドの目的とメッセージを整理。必要なら`plan`でタスク分解
3. **実装**: `slides.md`やコンポーネントを編集。ClaudeはPlaywrightで逐次確認し、Codexは最小差分を意識
4. **検証**: Playwright MCPでレンダリング確認、必要に応じて`pnpm test`やLintを実行
5. **共有**: 最終レスポンスで変更要約、レビュー観点、次アクションを提示。必要なスクリーンショットや参照行を添える

## 主要リファレンス
- `AGENTS.md`: 本ガイドラインとエージェント運用フロー
- `slides.md`: Slidev本体。大幅変更前に`slides_backup.md`で構造を確認
- `slides_backup.md`: 既存構成の比較用バックアップ
- `assets/`: ロゴ等のブランドアセット置き場。命名はkebab-case
- `serena.config.json`: Serena MCP設定。対象パス変更時は各エージェントへ周知

## 運用のヒント
- 会話が長引く場合でも、Serena MCPの自動コンテキストで本ドキュメントの指示が失われないかを定期チェック
- 変更の影響範囲が広い場合は、中間レビュー用に差分スクリーンショットや要約を残すと移譲が楽になる
- 誤った操作を検知したら即座に手を止めて報告し、勝手にロールバックしない
- 追加で必要なガイドラインがあれば、本ドキュメントに追記し、全エージェントへ共有すること
